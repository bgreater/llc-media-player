<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Content Management Corp.</title>
<meta name="description" content="Media Player">
<meta name="author" content="B>">
<link href="css/default.css" rel="Stylesheet" type="text/css">
<link href="skin/blue.monday/jplayer.blue.monday.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.xml2json.pack.js"></script>
<script type="text/javascript" src="js/jquery.jplayer.min.js"></script>
</head>
<body>
<div class="player">
  <div class="playerFrame">
    <div id="slides"></div>
    <div id="jquery_jplayer_1" class="jp-jplayer"></div>
    <div id="jp_container_1" class="jp-audio">
      <div class="jp-type-single">
        <div class="jp-gui jp-interface">
          <ul class="jp-controls">
            <li><a href="javascript:;" class="jp-play" tabindex="1">play</a></li>
            <li><a href="javascript:;" class="jp-pause" tabindex="1">pause</a></li>
            <li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li>
            <li><a href="javascript:;" class="jp-mute" tabindex="1" title="mute">mute</a></li>
            <li><a href="javascript:;" class="jp-unmute" tabindex="1" title="unmute">unmute</a></li>
            <li><a href="javascript:;" class="jp-volume-max" tabindex="1" title="max volume">max volume</a></li>
          </ul>
          <div class="jp-progress">
            <div class="jp-seek-bar">
              <div class="jp-play-bar"></div>
            </div>
          </div>
          <div class="jp-volume-bar">
            <div class="jp-volume-bar-value"></div>
          </div>
          <div class="jp-time-holder">
            <div class="jp-current-time"></div>
            <div class="jp-duration"></div>
            <ul class="jp-toggles">
              <li><a href="javascript:;" class="jp-repeat" tabindex="1" title="repeat">repeat</a></li>
              <li><a href="javascript:;" class="jp-repeat-off" tabindex="1" title="repeat off">repeat off</a></li>
            </ul>
          </div>
        </div>
        <div class="jp-title"></div>
        <div class="jp-no-solution"> <span>Update Required</span> To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>. </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
//<![CDATA[ 			  

var pres; // Global JSON object of presentation
  
$.get('presentation.xml', function(xml){ // On successful xml load
	
	pres = $.xml2json(xml); // convert xml to object 
	  
	// Set title
	$("div.jp-title").text(pres.title);
	  
	// Setup Slides
	$(pres.media.items.item).each(function(i){
		
		if(this.fileType == "jpg"){ // jpg slide
		
			$('<a id="'+this.id+'" class="slide" href="'+this.link+'"><img src="'+this.file.text+'" /></a>').appendTo("#slides");
		
		} else if (this.fileType == "video") { // video slide
		
		}
		
	}); 
		  
	// Initialize jPlayer
	$("#jquery_jplayer_1").jPlayer({
		ready: function (event) {
	    	$.jPlayer.timeFormat.showHour = true; // set show hours
	      	$(this).jPlayer("setMedia", {
	        	mp3:pres.media.master.item.file.text // Assumes one master file
	    	});
	    },
	    swfPath: "js",
	    supplied: pres.media.master.item.fileType, // Assumes mp3 file type
	    wmode: "window"
	});
	  
	// Set Current time/Slide function
	$("#jquery_jplayer_1").bind($.jPlayer.event.timeupdate, function(event) { 
	  
	  
		// Slide to show, intially first item
	    var timeNow = event.jPlayer.status.currentTime,
	    	curEl	= pres.media.items.item[0]; 
		
		// Determine Slide closest to play head	but not before current Time
		$(pres.media.items.item).each(function(i){
			curEl = (this.startPoint/1000)-timeNow <= 0 && Math.abs((curEl.startPoint/1000)-timeNow) >= Math.abs((this.startPoint/1000)-timeNow) ? this : curEl ; 
		});
		
		// Show Hide elements
		$("#"+curEl.id).show();
		$("#slides .slide").not("#"+curEl.id).hide();

	});

});
  
//]]>
</script>
</body>
</html>
